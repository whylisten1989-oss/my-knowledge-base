<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MindForge Finance (V5.3 - Pro)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3.3.4/dist/vue.global.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

    <link rel="stylesheet" href="css/global.css">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { 'bg-dark': '#000000', 'bg-light': '#f8fafc' },
                    fontFamily: { sans: ['"JetBrains Mono"', '"Microsoft YaHei"', 'sans-serif'] }
                }
            }
        }
    </script>

    <style>
        [v-cloak] { display: none; }
        
        /* ‰øÆÂ§ç 4: ÈöêËóèÊï∞Â≠óËæìÂÖ•Ê°ÜÂè≥ËæπÁöÑ‰∏ä‰∏ãÁÆ≠Â§¥Êéß‰ª∂ */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }

        .log-item {
            display: flex; align-items: center; justify-content: space-between;
            padding: 12px 16px; margin-bottom: 8px;
            border-radius: 12px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid transparent;
        }
        .dark .log-item { background: rgba(255, 255, 255, 0.03); border-color: rgba(255, 255, 255, 0.05); }
        .dark .log-item:hover { background: rgba(255, 255, 255, 0.08); border-color: rgba(255, 255, 255, 0.2); transform: scale(1.01); }
        html:not(.dark) .log-item { background: #fff; border-color: rgba(0, 0, 0, 0.05); box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        html:not(.dark) .log-item:hover { border-color: rgba(0, 0, 0, 0.1); transform: scale(1.01); }

        .log-icon-box {
            width: 36px; height: 36px; border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 10px; font-weight: bold; margin-right: 12px;
        }
        .bg-inc { background: rgba(16, 185, 129, 0.15); color: #10b981; }
        .bg-exp { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .bg-inv { background: rgba(59, 130, 246, 0.15); color: #3b82f6; } 

        .view-tab.active::after {
            content: ''; position: absolute; bottom: -4px; left: 50%; transform: translateX(-50%);
            width: 20px; height: 2px; background-color: #3b82f6; border-radius: 2px;
        }
    </style>
</head>
<body class="bg-bg-light dark:bg-bg-dark h-screen flex overflow-hidden transition-colors duration-500 text-gray-900 dark:text-gray-200">

<script src="js/config.js"></script>

<div class="fixed inset-0 pointer-events-none z-0 transition-opacity duration-1000">
    <div class="absolute inset-0 opacity-0 dark:opacity-100 transition-opacity duration-1000">
        <div class="absolute top-[-20%] left-[-10%] w-[50vw] h-[50vw] bg-blue-900/10 blur-[150px] rounded-full"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-[50vw] h-[50vw] bg-purple-900/10 blur-[150px] rounded-full"></div>
    </div>
</div>

<div id="app" v-cloak class="h-full w-full flex relative z-10">

    <aside :class="['floating-sidebar w-64 flex flex-col justify-between transition-transform duration-300 fixed md:relative z-40', mobileMenuOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0']">
        <div>
            <div class="h-20 flex items-center px-8 border-b border-gray-200 dark:border-white/5">
                <span class="text-xl font-black tracking-tighter text-black dark:text-white cyber-logo">MindForge <span class="text-[10px] opacity-60 ml-1 font-normal">FINANCE</span></span>
            </div>
            <nav class="p-4 space-y-6">
                <div>
                    <div class="text-[10px] font-bold text-gray-400 dark:text-gray-600 uppercase tracking-widest mb-3 pl-4">Core</div>
                    <a href="index.html" class="nav-item w-full text-left block p-3 mb-1 text-xs">System Home</a>
                    <button class="nav-item w-full text-left block p-3 text-xs active">Finance ÈáëËûç</button>
                    </div>
            </nav>
        </div>
        <div class="p-6 border-t border-gray-200 dark:border-white/5">
            <div class="text-[10px] text-gray-500 font-mono">SECURE CONNECTION</div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col bg-transparent relative w-full pl-4 pt-4 no-scroll-x">
        
        <header class="h-16 flex items-center justify-between px-8 shrink-0 mb-4 mr-4 cyber-card z-[60] sticky top-0 bg-white/80 dark:bg-[#0a0a0a]/80 backdrop-blur-xl border border-gray-200 dark:border-white/10 shadow-lg !overflow-visible">
            <div class="flex items-center gap-6">
                <button @click="mobileMenuOpen = !mobileMenuOpen" class="md:hidden text-2xl">‚ò∞</button>
                <div class="flex flex-col relative justify-center">
                    <span class="text-[9px] font-bold text-gray-500 uppercase tracking-[0.2em] mb-1">Financial Intelligence</span>
                    <div class="relative">
                        <div v-if="currentView === 'cashflow'">
                            <button @click="showMonthPicker = !showMonthPicker" class="month-trigger-btn text-black dark:text-white text-xs font-bold">
                                <span>{{ selectedYear }}</span><span class="text-gray-400">.</span><span>{{ selectedMonth < 10 ? '0'+selectedMonth : selectedMonth }}</span><span class="text-[8px] text-gray-400 ml-1">‚ñº</span>
                            </button>
                            <div v-if="showMonthPicker" class="absolute top-full left-0 mt-2 w-56 p-3 bg-white/95 dark:bg-[#0a0a0a]/95 border border-gray-200 dark:border-white/20 rounded-xl shadow-2xl backdrop-blur-xl z-[70] animate-fade-in">
                                <div class="flex justify-between items-center mb-3 border-b border-gray-200 dark:border-white/10 pb-2">
                                    <button @click="selectedYear--" class="text-gray-500 hover:text-black dark:hover:text-white px-2 hover:bg-gray-100 dark:hover:bg-white/10 rounded">‚óÄ</button>
                                    <span class="text-black dark:text-white font-bold font-mono">{{ selectedYear }}</span>
                                    <button @click="selectedYear++" class="text-gray-500 hover:text-black dark:hover:text-white px-2 hover:bg-gray-100 dark:hover:bg-white/10 rounded">‚ñ∂</button>
                                </div>
                                <div class="grid grid-cols-4 gap-1">
                                    <button v-for="m in 12" :key="m" @click="setMonth(m)" :class="['text-[10px] py-1.5 rounded-md border transition', selectedMonth == m ? 'bg-black text-white dark:bg-white dark:text-black font-bold border-transparent' : 'text-gray-500 border-transparent hover:text-black dark:hover:text-white hover:bg-gray-100 dark:hover:bg-white/10']">{{ m }}Êúà</button>
                                </div>
                            </div>
                        </div>
                        <div v-else class="text-xs font-bold text-black dark:text-white">STOCK PORTFOLIO</div>
                    </div>
                </div>
            </div>
            
            <div class="absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 flex gap-1 p-1 bg-gray-100 dark:bg-white/5 rounded-lg border border-gray-200 dark:border-white/10">
                <button @click="switchView('cashflow')" :class="['px-4 py-1.5 text-[10px] font-bold uppercase tracking-wider rounded transition', currentView === 'cashflow' ? 'bg-white dark:bg-[#0a0a0a] text-black dark:text-white shadow-sm' : 'text-gray-400 hover:text-gray-600 dark:hover:text-gray-300']">Cashflow</button>
                <button @click="switchView('portfolio')" :class="['px-4 py-1.5 text-[10px] font-bold uppercase tracking-wider rounded transition', currentView === 'portfolio' ? 'bg-white dark:bg-[#0a0a0a] text-black dark:text-white shadow-sm' : 'text-gray-400 hover:text-gray-600 dark:hover:text-gray-300']">Portfolio</button>
            </div>

            <div class="flex items-center gap-4">
                <button @click="toggleTheme" class="w-8 h-8 flex items-center justify-center rounded-full border border-gray-300 dark:border-white/20 text-gray-500 hover:bg-gray-100 dark:hover:bg-white/10 transition">
                    <span v-if="isDark">‚òÄ</span><span v-else>‚òæ</span>
                </button>
                <button v-if="currentView === 'cashflow'" @click="openAddModal" class="btn-cyber text-black dark:text-white border-gray-300 dark:border-white/20 rounded-lg hover:bg-black hover:text-white dark:hover:bg-white dark:hover:text-black">
                    + Record
                </button>
                <button v-else @click="openAssetModal" class="btn-cyber text-blue-500 border-blue-500/30 rounded-lg hover:bg-blue-500 hover:text-white">
                    + Stock
                </button>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto pr-4 pb-4 relative z-10 custom-scroll h-[calc(100vh-80px)]">
            
            <div v-if="currentView === 'cashflow'" class="w-full space-y-6 animate-fade-in pt-2">
                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                    <div class="lg:col-span-1 cyber-card p-8 flex flex-col justify-center bg-gradient-to-br from-blue-50/50 to-white dark:from-blue-900/20 dark:to-transparent">
                        <div class="text-[10px] text-blue-500 font-bold uppercase tracking-widest mb-2">Lifetime Net Worth</div>
                        <div class="text-3xl lg:text-4xl font-black text-black dark:text-white tracking-tight font-mono truncate">¬• {{ nFormatter(lifetimeStats.net) }}</div>
                    </div>
                    <div class="lg:col-span-3 grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="cyber-card p-5 flex flex-col justify-center">
                            <div class="text-[9px] text-gray-500 uppercase tracking-widest mb-1">Income</div>
                            <div class="text-lg font-bold text-green-600 dark:text-green-400 truncate">+ {{ nFormatter(currentMonthStats.income) }}</div>
                        </div>
                        <div class="cyber-card p-5 flex flex-col justify-center">
                            <div class="text-[9px] text-gray-500 uppercase tracking-widest mb-1">Expense</div>
                            <div class="text-lg font-bold text-red-500 dark:text-red-400 truncate">- {{ nFormatter(currentMonthStats.expense) }}</div>
                        </div>
                        <div class="cyber-card p-5 flex flex-col justify-center">
                            <div class="text-[9px] text-gray-500 uppercase tracking-widest mb-1">Net</div>
                            <div class="text-lg font-bold text-black dark:text-white truncate">{{ nFormatter(currentMonthStats.net) }}</div>
                        </div>
                        <div class="cyber-card p-5 flex flex-col justify-center relative">
                            <div class="text-[9px] text-gray-500 uppercase tracking-widest mb-1">Savings Rate</div>
                            <div :class="['text-2xl font-black z-10', savingsRate >= 50 ? 'text-green-600 dark:text-green-400' : (savingsRate > 0 ? 'text-blue-500 dark:text-blue-400' : 'text-red-500')]">{{ savingsRate }}%</div>
                            <div class="absolute bottom-0 left-0 h-1 bg-gray-200 dark:bg-white/5 w-full"><div class="h-full transition-all duration-1000" :style="{ width: Math.max(0, Math.min(100, savingsRate)) + '%', backgroundColor: savingsRate >= 50 ? '#10b981' : (savingsRate > 0 ? '#3b82f6' : '#ef4444') }"></div></div>
                        </div>
                    </div>
                </div>

                <div class="cyber-card p-6 h-80 flex flex-col">
                    <h3 class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2">Daily Trend ({{ selectedMonth }}Êúà)</h3>
                    <div id="chart-daily" class="flex-1 w-full"></div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 h-96 lg:h-80">
                    <div class="cyber-card p-6 flex flex-col">
                        <h3 class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2">Savings Trend</h3>
                        <div id="chart-history" class="flex-1 w-full"></div>
                    </div>
                    <div class="cyber-card p-6 flex flex-col">
                        <h3 class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2">Structure</h3>
                        <div id="chart-pie" class="flex-1 w-full"></div>
                    </div>
                    <div class="cyber-card flex-1 flex flex-col overflow-hidden">
                        <div class="p-4 border-b border-gray-200 dark:border-white/5 bg-gray-50 dark:bg-black/20 flex justify-between items-center">
                            <h3 class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Log</h3>
                            <span class="text-[10px] font-mono text-gray-400">{{ filteredTransactions.length }} ITEMS</span>
                        </div>
                        <div class="overflow-y-auto flex-1 p-3 custom-scroll">
                            <div v-for="item in filteredTransactions" :key="item.id" class="log-item group">
                                <div class="flex items-center">
                                    <div :class="['log-icon-box', item.type === 'expense' ? 'bg-exp' : 'bg-inc']">
                                        {{ item.type === 'expense' ? 'OUT' : 'IN' }}
                                    </div>
                                    <div>
                                        <div class="text-xs font-bold text-black dark:text-white mb-0.5">{{ item.title }}</div>
                                        <div class="text-[9px] text-gray-400 font-mono flex items-center gap-2">
                                            <span>{{ item.date }}</span>
                                            <span class="uppercase">{{ item.category }}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div :class="['text-xs font-mono font-bold', item.type === 'expense' ? 'text-red-500 dark:text-red-400' : 'text-green-600 dark:text-green-400']">
                                        {{ item.type === 'expense' ? '-' : '+' }} {{ nFormatter(item.amount) }}
                                    </div>
                                    <button @click="deleteTransaction(item.id)" class="text-[9px] text-gray-400 hover:text-red-500 font-bold opacity-0 group-hover:opacity-100 transition mt-1 uppercase">Delete</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div v-else class="w-full h-full flex flex-col gap-6 animate-fade-in pt-2">
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="cyber-card p-8 relative overflow-hidden group col-span-1">
                        <div class="absolute inset-0 bg-gradient-to-r from-blue-900/10 to-purple-900/10 z-0"></div>
                        <div class="relative z-10">
                            <div class="text-[10px] text-blue-500 font-bold uppercase tracking-widest mb-3">Total Invested Á¥ØËÆ°ÊäïÂÖ•</div>
                            <div class="text-3xl font-black text-black dark:text-white tracking-tight font-mono mb-2">¬• {{ nFormatter(investmentStats.invested) }}</div>
                            <div class="flex items-center gap-2">
                                <span class="text-[10px] text-gray-400 uppercase">Realized Gains Â∑≤ËêΩË¢ãÊî∂Áõä</span>
                                <span class="text-xs font-bold text-green-600 dark:text-green-400 font-mono">+ {{ nFormatter(investmentStats.gains) }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="cyber-card p-6 col-span-2 flex flex-col h-48 lg:h-auto">
                        <h3 class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2">Monthly P&L (Realized) ÊúàÂ∫¶Áõà‰∫è</h3>
                        <div id="chart-stock-trend" class="flex-1 w-full"></div>
                    </div>
                </div>

                <div class="flex-1 grid grid-cols-1 lg:grid-cols-3 gap-6 min-h-[400px]">
                    <div class="lg:col-span-2 cyber-card flex flex-col overflow-hidden">
                        <div class="p-5 border-b border-gray-200 dark:border-white/5 flex justify-between items-center bg-gray-50 dark:bg-white/5">
                            <h3 class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Transaction Log</h3>
                            <span class="text-[10px] font-mono text-gray-400">{{ investmentTransactions.length }} RECORDS</span>
                        </div>
                        <div class="overflow-y-auto flex-1 p-3 custom-scroll">
                             <div v-if="investmentTransactions.length === 0" class="h-full flex flex-col items-center justify-center text-gray-400 opacity-50">
                                <div class="text-2xl mb-2">üì≠</div>
                                <div class="text-xs font-mono">No investment records yet</div>
                            </div>
                            <div v-for="item in investmentTransactions" :key="item.id" class="log-item group">
                                <div class="flex items-center">
                                    <div :class="['log-icon-box', item.type === 'expense' ? 'bg-inv' : 'bg-inc']">
                                        {{ item.type === 'expense' ? 'BUY' : 'SELL' }}
                                    </div>
                                    <div>
                                        <div class="text-xs font-bold text-black dark:text-white mb-0.5">{{ item.title }}</div>
                                        <div class="text-[9px] text-gray-400 font-mono flex items-center gap-2">
                                            <span>{{ item.date }}</span>
                                            <span v-if="item.code" class="bg-gray-200 dark:bg-white/10 px-1 rounded text-[8px]">{{ item.code }}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div :class="['text-xs font-mono font-bold', item.type === 'expense' ? 'text-black dark:text-white' : 'text-green-500']">
                                        {{ item.type === 'expense' ? '-' : '+' }} {{ nFormatter(item.amount) }}
                                    </div>
                                    <button @click="deleteTransaction(item.id)" class="text-[9px] text-gray-400 hover:text-red-500 font-bold opacity-0 group-hover:opacity-100 transition mt-1 uppercase">Revert</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="cyber-card p-6 flex flex-col">
                         <h3 class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2">Performance Distribution</h3>
                         <div id="chart-stock-allocation" class="flex-1 w-full"></div>
                    </div>
                </div>

            </div>

        </div>
    </main>

    <div v-if="showModal" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 dark:bg-black/90 p-4 backdrop-blur-md animate-fade-in">
        <div class="cyber-card w-full max-w-md p-8 shadow-2xl relative bg-white dark:bg-[#0a0a0a]">
            <button @click="showModal = false" class="absolute top-4 right-4 text-gray-400 hover:text-black dark:hover:text-white">‚úï</button>
            <h2 class="text-xl font-black text-black dark:text-white mb-6 tracking-tighter">NEW ENTRY (CASHFLOW)</h2>
            <div class="space-y-5">
                <div class="flex p-1 bg-gray-100 dark:bg-black/50 rounded-lg border border-gray-200 dark:border-white/10">
                    <button @click="form.type = 'expense'" :class="['flex-1 py-2 text-xs font-bold transition uppercase tracking-wider rounded-md', form.type === 'expense' ? 'bg-white dark:bg-red-900/20 text-red-500 border border-gray-200 dark:border-red-500/30 shadow-sm' : 'text-gray-400 hover:text-black dark:hover:text-white']">Expense</button>
                    <button @click="form.type = 'income'" :class="['flex-1 py-2 text-xs font-bold transition uppercase tracking-wider rounded-md', form.type === 'income' ? 'bg-white dark:bg-green-900/20 text-green-500 border border-gray-200 dark:border-green-500/30 shadow-sm' : 'text-gray-400 hover:text-black dark:hover:text-white']">Income</button>
                </div>
                <div class="space-y-1"><label class="text-[9px] text-gray-400 uppercase font-bold pl-1">Amount</label><input v-model="form.amount" type="number" placeholder="0.00" class="cyber-input"></div>
                <div class="space-y-1"><label class="text-[9px] text-gray-400 uppercase font-bold pl-1">Title</label><input v-model="form.title" type="text" placeholder="Detail..." class="cyber-input"></div>
                <div class="space-y-1">
                    <label class="text-[9px] text-gray-400 uppercase font-bold pl-1">Date</label>
                    <div class="flex gap-2">
                        <div class="relative flex-1"><select v-model="formYear" class="cyber-input p-2 text-xs text-center cursor-pointer appearance-none"><option v-for="y in 5" :key="y" :value="2023 + y">{{ 2023 + y }}</option></select></div>
                        <div class="relative flex-1"><select v-model="formMonth" class="cyber-input p-2 text-xs text-center cursor-pointer appearance-none"><option v-for="m in 12" :key="m" :value="m">{{ m }}Êúà</option></select></div>
                        <div class="relative flex-1"><select v-model="formDay" class="cyber-input p-2 text-xs text-center cursor-pointer appearance-none"><option v-for="d in daysInFormMonth" :key="d" :value="d">{{ d }}Êó•</option></select></div>
                    </div>
                </div>
                <div class="space-y-1"><label class="text-[9px] text-gray-400 uppercase font-bold pl-1">Category</label><div class="grid grid-cols-4 gap-2"><button v-for="cat in currentCategories" :key="cat" @click="form.category = cat" :class="['py-2 text-[9px] font-bold border transition uppercase rounded-md', form.category === cat ? 'bg-black text-white dark:bg-white dark:text-black border-transparent' : 'bg-transparent text-gray-400 border-gray-200 dark:border-white/10 hover:border-black dark:hover:border-white/40 hover:text-black dark:hover:text-white']">{{ cat }}</button></div></div>
            </div>
            <div class="flex gap-4 mt-8"><button @click="saveTransaction" class="flex-1 btn-cyber rounded-lg w-full bg-black text-white dark:bg-white dark:text-black">CONFIRM</button></div>
        </div>
    </div>

    <div v-if="showAssetModal" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 dark:bg-black/90 p-4 backdrop-blur-md animate-fade-in">
        <div class="cyber-card w-full max-w-md p-8 shadow-2xl relative bg-white dark:bg-[#0a0a0a] border border-blue-500/30">
            <button @click="showAssetModal = false" class="absolute top-4 right-4 text-gray-400 hover:text-black dark:hover:text-white">‚úï</button>
            <h2 class="text-xl font-black text-blue-600 dark:text-blue-500 mb-6 tracking-tighter">STOCK TRANSACTION</h2>
            
            <div class="space-y-5">
                <div class="flex p-1 bg-gray-100 dark:bg-black/50 rounded-lg border border-gray-200 dark:border-white/10">
                    <button @click="assetForm.action = 'buy'" :class="['flex-1 py-2 text-xs font-bold transition uppercase tracking-wider rounded-md', assetForm.action === 'buy' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-400 hover:text-black dark:hover:text-white']">Buy (‰π∞ÂÖ•)</button>
                    <button @click="assetForm.action = 'sell'" :class="['flex-1 py-2 text-xs font-bold transition uppercase tracking-wider rounded-md', assetForm.action === 'sell' ? 'bg-green-600 text-white shadow-lg' : 'text-gray-400 hover:text-black dark:hover:text-white']">Sell (ÂçñÂá∫)</button>
                </div>

                <div class="grid grid-cols-3 gap-2">
                    <div class="col-span-1 space-y-1">
                        <label class="text-[9px] text-gray-400 uppercase font-bold pl-1">Code</label>
                        <input v-model="assetForm.code" type="text" placeholder="00700" class="cyber-input font-bold text-center">
                    </div>
                    <div class="col-span-2 space-y-1">
                        <label class="text-[9px] text-gray-400 uppercase font-bold pl-1">Name</label>
                        <input v-model="assetForm.name" type="text" placeholder="Tencent" class="cyber-input font-bold">
                    </div>
                </div>

                <div class="space-y-1">
                    <label class="text-[9px] text-gray-400 uppercase font-bold pl-1">{{ assetForm.action === 'buy' ? 'Total Cost (¬•)' : 'Total Sell Amount (¬•)' }}</label>
                    <input v-model="assetForm.amount" type="number" placeholder="Total Value" class="cyber-input text-lg">
                </div>
                
                <div v-if="assetForm.action === 'sell'" class="space-y-1 animate-fade-in">
                    <label class="text-[9px] text-gray-400 uppercase font-bold pl-1">Original Cost (¬•)</label>
                    <input v-model="assetForm.cost" type="number" placeholder="How much did you pay?" class="cyber-input border-yellow-500/30 focus:border-yellow-500">
                    <div v-if="assetForm.amount && assetForm.cost" class="text-right text-[10px] font-mono">
                        Profit: <span :class="assetForm.amount - assetForm.cost >= 0 ? 'text-green-500' : 'text-red-500'">{{ (assetForm.amount - assetForm.cost).toFixed(2) }}</span>
                    </div>
                </div>
                
                <div class="p-3 bg-blue-50 dark:bg-blue-900/10 rounded border border-blue-100 dark:border-blue-500/20 text-[10px] text-blue-600 dark:text-blue-400 leading-relaxed">
                    <span v-if="assetForm.action === 'buy'">
                        <b>LOGIC:</b> Recorded as <b>Expense (ÊäïËµÑ)</b>. Cash -{{ assetForm.amount || 0 }}.
                    </span>
                    <span v-else>
                        <b>LOGIC:</b> Profit ({{ assetForm.amount - assetForm.cost || 0 }}) recorded as <b>Income (ÁêÜË¥¢Êî∂Áõä)</b>.
                    </span>
                </div>
            </div>
            
            <div class="flex gap-4 mt-8">
                <button @click="saveAssetTransaction" class="flex-1 btn-cyber rounded-lg w-full bg-blue-600 text-white hover:bg-blue-700 border-transparent">
                    EXECUTE ORDER
                </button>
            </div>
        </div>
    </div>

</div>
<script>
    const { createApp, ref, onMounted, reactive, computed, watch, nextTick } = Vue

    createApp({
        setup() {
            // --- Âü∫Á°ÄÈÖçÁΩÆ ---
            if (!window._supabase) { console.error("Config Error"); return {}; }
            const _supabase = window._supabase; 

            const isDark = ref(true)
            if (localStorage.getItem('theme') === 'light') { isDark.value = false; document.documentElement.classList.remove('dark'); }
            const toggleTheme = () => { isDark.value = !isDark.value; if(isDark.value){document.documentElement.classList.add('dark');localStorage.setItem('theme','dark')}else{document.documentElement.classList.remove('dark');localStorage.setItem('theme','light')} }

            // --- ËßÜÂõæÂàáÊç¢ÈÄªËæë ---
            const currentView = ref('cashflow')
            const switchView = (view) => { 
                currentView.value = view; 
                // ÂàáÊç¢ËßÜÂõæÊó∂Âà∑Êñ∞ÂõæË°®ÔºåÁªô‰∏ÄÁÇπÂª∂ËøüÁ°Æ‰øù DOM Ê∏≤ÊüìÂÆåÊàê
                setTimeout(() => updateAllCharts(), 200);
            }

            // --- Áä∂ÊÄÅÂèòÈáè ---
            const mobileMenuOpen = ref(false)
            const showModal = ref(false)
            const showAssetModal = ref(false)
            const showMonthPicker = ref(false)
            const transactions = ref([])
            
            // --- Êó•ÊúüÊéßÂà∂ ---
            const now = new Date()
            const selectedYear = ref(now.getFullYear())
            const selectedMonth = ref(now.getMonth() + 1)
            const formYear = ref(now.getFullYear())
            const formMonth = ref(now.getMonth() + 1)
            const formDay = ref(now.getDate())

            const daysInFormMonth = computed(() => new Date(formYear.value, formMonth.value, 0).getDate())
            watch([formYear, formMonth], () => { const max = new Date(formYear.value, formMonth.value, 0).getDate(); if(formDay.value > max) formDay.value = max; })

            // --- ÂàÜÁ±ªÂÆö‰πâ ---
            const expenseCategories = ['È§êÈ•Æ', '‰∫§ÈÄö', 'Ë¥≠Áâ©', 'Â®±‰πê', 'ÊäïËµÑ', 'ÂÇ®ËìÑ', 'ÁêÜË¥¢', 'Âõ∫ÂÆö']
            const incomeCategories = ['Â∑•ËµÑ', 'ÂÖºËÅå', 'ÁêÜË¥¢Êî∂Áõä', 'Â•ñÈáë', 'ÂÖ∂‰ªñ']
            
            // --- Ë°®ÂçïÊï∞ÊçÆ ---
            const form = reactive({ type: 'expense', amount: '', title: '', category: '' })
            // Êñ∞Â¢û cost Áî®‰∫éËÆ°ÁÆóÂçñÂá∫Êî∂ÁõäÔºåcode Áî®‰∫éËÇ°Á•®‰ª£Á†Å
            const assetForm = reactive({ action: 'buy', name: '', code: '', amount: '', cost: '' })

            const currentCategories = computed(() => form.type === 'expense' ? expenseCategories : incomeCategories)

            // --- Êï∞ÊçÆËÆ°ÁÆó Core ---
            const currentMonthKey = computed(() => `${selectedYear.value}-${selectedMonth.value < 10 ? '0'+selectedMonth.value : selectedMonth.value}`)
            const filteredTransactions = computed(() => transactions.value.filter(t => t.date.startsWith(currentMonthKey.value)))
            
            // ÊäïËµÑ‰∏ìÂ±ûÊï∞ÊçÆÊ∫ê
            const investmentTransactions = computed(() => {
                return transactions.value.filter(t => 
                    t.category === 'ÊäïËµÑ' || t.category === 'ÁêÜË¥¢Êî∂Áõä'
                ).sort((a,b) => new Date(b.date) - new Date(a.date))
            })

            // ÊäïËµÑÁªüËÆ°Èù¢Êùø
            const investmentStats = computed(() => {
                // Á¥ØËÆ°ÊäïÂÖ•ÔºöÊâÄÊúâ‚ÄúÊäïËµÑ‚ÄùÁ±ªÂà´ÁöÑÊîØÂá∫
                const invested = investmentTransactions.value.filter(t => t.type === 'expense' && t.category === 'ÊäïËµÑ').reduce((s,t) => s + Number(t.amount), 0)
                // Á¥ØËÆ°Êî∂ÁõäÔºöÊâÄÊúâ‚ÄúÁêÜË¥¢Êî∂Áõä‚ÄùÁ±ªÂà´ÁöÑÊî∂ÂÖ•
                const gains = investmentTransactions.value.filter(t => t.type === 'income' && t.category === 'ÁêÜË¥¢Êî∂Áõä').reduce((s,t) => s + Number(t.amount), 0)
                return { invested, gains }
            })
            
            // Áé∞ÈáëÊµÅÁªüËÆ°
            const lifetimeStats = computed(() => {
                const inc = transactions.value.filter(t => t.type === 'income').reduce((s, t) => s + Number(t.amount), 0)
                const exp = transactions.value.filter(t => t.type === 'expense').reduce((s, t) => s + Number(t.amount), 0)
                return { income: inc, expense: exp, net: inc - exp }
            })
            const currentMonthStats = computed(() => {
                const inc = filteredTransactions.value.filter(t => t.type === 'income').reduce((s, t) => s + Number(t.amount), 0)
                const exp = filteredTransactions.value.filter(t => t.type === 'expense').reduce((s, t) => s + Number(t.amount), 0)
                return { income: inc, expense: exp, net: inc - exp }
            })
            const savingsRate = computed(() => {
                const inc = currentMonthStats.value.income
                if (inc === 0) return 0
                return (((inc - currentMonthStats.value.expense) / inc) * 100).toFixed(1)
            })

            // Êï∞Â≠óÊ†ºÂºèÂåñ (‰øùÁïô2‰ΩçÂ∞èÊï∞)
            const nFormatter = (num) => {
                if (!num && num !== 0) return '0.00';
                return Number(num).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })
            }

            // --- ECharts ÂÆû‰æã ---
            let dailyChart = null, historyChart = null, pieChart = null;
            let stockTrendChart = null, stockAllocChart = null;

            // 1. Daily Trend (‰øÆÂ§çÔºö0ÂÄº‰∏çÊòæÁ§∫Á∫øÔºåÈöêËóèÊ†áÁ≠æ)
            const updateDailyChart = () => {
                const el = document.getElementById('chart-daily'); if (!el) return; if (dailyChart) dailyChart.dispose(); dailyChart = echarts.init(el);
                const data = filteredTransactions.value; 
                const daysInMonth = new Date(selectedYear.value, selectedMonth.value, 0).getDate(); 
                const days = Array.from({length: daysInMonth}, (_, i) => (i + 1).toString()); 
                // ‰ΩøÁî® null ËÄå‰∏çÊòØ 0ÔºåËøôÊ†∑ ECharts ‰ºöÊñ≠ÂºÄËøûÁ∫øÔºå‰∏çÊòæÁ§∫ 0 ÂÄºÁöÑÁÇπ
                const dailyTotal = new Array(daysInMonth).fill(null); 
                
                data.filter(t => t.type === 'expense').forEach(t => { 
                    if (t.category !== 'ÂÇ®ËìÑ') { 
                        const dayIndex = parseInt(t.date.split('-')[2]) - 1; 
                        const val = Number(t.amount); 
                        // Â¶ÇÊûú‰πãÂâçÊòØ nullÔºåÂÖàÁΩÆ 0 ÂÜçÂä†
                        if(dailyTotal[dayIndex] === null) dailyTotal[dayIndex] = 0;
                        dailyTotal[dayIndex] += val; 
                    } 
                });

                const isDarkTheme = document.documentElement.classList.contains('dark'); 
                const axisColor = isDarkTheme ? '#333' : '#e5e7eb'; 
                const textColor = isDarkTheme ? '#666' : '#9ca3af';
                
                dailyChart.setOption({ 
                    backgroundColor: 'transparent', 
                    tooltip: { trigger: 'axis' }, 
                    grid: { top: 30, right: 10, bottom: 20, left: 40 }, 
                    xAxis: { type: 'category', data: days, axisLine: { lineStyle: { color: axisColor } }, axisLabel: { color: textColor } }, 
                    yAxis: { type: 'value', splitLine: { lineStyle: { color: axisColor } }, axisLabel: { color: textColor } }, 
                    series: [{ 
                        name: 'TOTAL', type: 'line', data: dailyTotal, smooth: true, connectNulls: false, // ‰∏çËøûÊé•Á©∫ÂÄº
                        lineStyle: { width: 3, color: '#3b82f6' }, areaStyle: { opacity: 0.2, color: '#3b82f6' }, 
                        // Ê†áÁ≠æÔºöÂè™ÊúâÂÄº > 0 ÊâçÊòæÁ§∫
                        label: { show: true, position: 'top', color: textColor, formatter: (p) => p.value > 0 ? p.value : '' } 
                    }] 
                }, true);
            }

            // 2. Savings Trend (‰øÆÂ§çÔºö‰∏çÊòæÁ§∫ÊäòÁ∫ø‰∏äÁöÑÊï∞Â≠ó)
            const updateHistoryChart = () => {
                const el = document.getElementById('chart-history'); if (!el) return; if (historyChart) historyChart.dispose(); historyChart = echarts.init(el);
                const monthlyData = {}; for(let i=1; i<=12; i++) { const k = `${selectedYear.value}-${i < 10 ? '0'+i : i}`; monthlyData[k] = { inc: 0, exp: 0 }; }
                transactions.value.forEach(t => { if (t.date.startsWith(selectedYear.value + '-')) { const k = t.date.slice(0, 7); if(monthlyData[k]) monthlyData[k][t.type === 'income' ? 'inc' : 'exp'] += Number(t.amount); } });
                const monthsLabel = Array.from({length:12}, (_, i) => (i+1) + 'Êúà'); 
                const rates = Object.keys(monthlyData).sort().map(m => { const d = monthlyData[m]; return d.inc > 0 ? ((d.inc - d.exp)/d.inc * 100).toFixed(1) : 0; });
                
                const isDarkTheme = document.documentElement.classList.contains('dark'); const axisColor = isDarkTheme ? '#333' : '#e5e7eb'; const textColor = isDarkTheme ? '#666' : '#9ca3af';
                
                historyChart.setOption({ 
                    backgroundColor: 'transparent', tooltip: { trigger: 'axis', formatter: '{b}<br/>ÂÇ®ËìÑÁéá: {c}%' }, 
                    grid: { top: 20, right: 10, bottom: 20, left: 30 }, 
                    xAxis: { type: 'category', data: monthsLabel, axisLine: { lineStyle: { color: axisColor } }, axisLabel: { color: textColor, fontSize: 9 } }, 
                    yAxis: { type: 'value', splitLine: { show: false }, axisLabel: { color: textColor, fontSize: 9 } }, 
                    series: [{ 
                        type: 'line', data: rates, smooth: true, 
                        lineStyle: { width: 2, color: '#10b981' }, areaStyle: { opacity: 0.2, color: '#10b981' }, symbol: 'circle',
                        label: { show: false } // ÈöêËóèÊäòÁ∫ø‰∏äÁöÑÊï∞Â≠ó
                    }] 
                });
            }

            // 3. Structure (‰øÆÂ§çÔºö‰∏çÊòæÁ§∫ÁôæÂàÜÊØîÔºåÂè™ÊòæÁ§∫ÈáëÈ¢ù)
            const updatePieChart = () => {
                const el = document.getElementById('chart-pie'); if (!el) return; if (pieChart) pieChart.dispose(); pieChart = echarts.init(el);
                const map = {}; filteredTransactions.value.filter(t => t.type === 'expense' && t.category !== 'ÂÇ®ËìÑ').forEach(t => map[t.category] = (map[t.category] || 0) + Number(t.amount));
                
                const isDarkTheme = document.documentElement.classList.contains('dark'); const labelColor = isDarkTheme ? '#888' : '#666'; const valueColor = isDarkTheme ? '#fff' : '#000';
                
                pieChart.setOption({ 
                    backgroundColor: 'transparent', tooltip: { trigger: 'item' }, 
                    series: [{ 
                        type: 'pie', radius: ['40%', '65%'], itemStyle: { borderRadius: 4, borderColor: isDarkTheme ? '#0a0a0a' : '#fff', borderWidth: 2 }, 
                        labelLine: { length: 10, length2: 0, lineStyle: { color: labelColor } }, 
                        // ‰øÆÊîπ formatter: Âè™ÊúâÂêçÂ≠óÂíåÈáëÈ¢ùÔºåÊ≤°Êúâ {d}%
                        label: { show: true, formatter: '{name|{b}}\n{value|¬•{c}}', rich: { name: { color: labelColor, fontSize: 10 }, value: { color: valueColor, fontSize: 10 } } }, 
                        data: Object.keys(map).map(k => ({ value: map[k], name: k })) 
                    }] 
                });
            }

            // 4. [NEW] Stock Trend (ÊúàÂ∫¶Êî∂ÁõäÁéáÂõæË°® - Êü±Áä∂Âõæ)
            const updateStockTrendChart = () => {
                const el = document.getElementById('chart-stock-trend'); if (!el) return; if (stockTrendChart) stockTrendChart.dispose(); stockTrendChart = echarts.init(el);
                
                const monthlyProfit = {};
                for(let i=1; i<=12; i++) { const k = `${selectedYear.value}-${i < 10 ? '0'+i : i}`; monthlyProfit[k] = 0; }
                
                // Âè™ÁªüËÆ° 'ÁêÜË¥¢Êî∂Áõä'
                investmentTransactions.value.filter(t => t.category === 'ÁêÜË¥¢Êî∂Áõä').forEach(t => {
                    if (t.date.startsWith(selectedYear.value + '-')) {
                        const k = t.date.slice(0, 7);
                        monthlyProfit[k] += Number(t.amount);
                    }
                });
                
                const months = Array.from({length:12}, (_, i) => (i+1) + 'Êúà');
                const values = Object.keys(monthlyProfit).sort().map(k => monthlyProfit[k]);
                
                const isDarkTheme = document.documentElement.classList.contains('dark'); const axisColor = isDarkTheme ? '#333' : '#e5e7eb'; const textColor = isDarkTheme ? '#666' : '#9ca3af';
                
                stockTrendChart.setOption({
                    backgroundColor: 'transparent', tooltip: { trigger: 'axis' },
                    grid: { top: 20, right: 10, bottom: 20, left: 30 },
                    xAxis: { type: 'category', data: months, axisLine: { lineStyle: { color: axisColor } }, axisLabel: { color: textColor, fontSize: 9 } },
                    yAxis: { type: 'value', splitLine: { lineStyle: { color: axisColor, type: 'dashed' } }, axisLabel: { color: textColor, fontSize: 9 } },
                    series: [{ 
                        type: 'bar', data: values, barWidth: '40%',
                        itemStyle: { color: (params) => params.value >= 0 ? '#10b981' : '#ef4444', borderRadius: [4, 4, 0, 0] }
                    }]
                });
            }

            // 5. [NEW] Stock Allocation (ÊäïËµÑÂàÜÂ∏ÉÂõæ)
            const updateStockAllocationChart = () => {
                const el = document.getElementById('chart-stock-allocation'); if (!el) return; if (stockAllocChart) stockAllocChart.dispose(); stockAllocChart = echarts.init(el);
                
                // ÁªüËÆ°ÊâÄÊúâ 'ÊäïËµÑ' Á±ªÂûãÁöÑÊîØÂá∫ÔºåÊåâ Title (ËÇ°Á•®ÂêçÁß∞) ÂàÜÁªÑ
                const map = {};
                investmentTransactions.value.filter(t => t.type === 'expense' && t.category === 'ÊäïËµÑ').forEach(t => {
                    // ‰ªé Title ‰∏≠ÊèêÂèñËÇ°Á•®ÂêçÁß∞ (ÂÅáËÆæÊ†ºÂºè Buy: Name ...)
                    let name = t.title.replace('Buy: ', '').trim();
                    // ÁÆÄÂçïÁöÑÂêçÂ≠óÊ∏ÖÁêÜÔºåÂéªÊéâ‰ª£Á†ÅÁ≠â
                    if(name.includes(' ')) name = name.split(' ')[0];
                    map[name] = (map[name] || 0) + Number(t.amount);
                });
                
                const isDarkTheme = document.documentElement.classList.contains('dark'); const labelColor = isDarkTheme ? '#888' : '#666';
                
                stockAllocChart.setOption({
                    backgroundColor: 'transparent', tooltip: { trigger: 'item' },
                    series: [{
                        type: 'pie', radius: ['40%', '70%'], center: ['50%', '50%'], roseType: 'radius',
                        itemStyle: { borderRadius: 4, borderColor: isDarkTheme ? '#0a0a0a' : '#fff', borderWidth: 2 },
                        label: { show: true, fontSize: 9, color: labelColor },
                        data: Object.keys(map).map(k => ({ value: map[k], name: k }))
                    }]
                });
            }

            const updateAllCharts = () => { 
                if(currentView.value === 'cashflow') { 
                    updateDailyChart(); updateHistoryChart(); updatePieChart(); 
                } else {
                    updateStockTrendChart(); updateStockAllocationChart();
                }
            }
            
            const fetchTransactions = async () => {
                const { data } = await _supabase.from('transactions').select('*').order('date', { ascending: true })
                if (data) { transactions.value = data; nextTick(() => updateAllCharts()); }
            }
            watch([selectedYear, selectedMonth, isDark], () => { setTimeout(updateAllCharts, 100); })

            const setMonth = (m) => { selectedMonth.value = m; showMonthPicker.value = false; }
            
            // Modal Controls
            const openAddModal = () => {
                form.amount = ''; form.title = ''; form.category = currentCategories.value[0]; 
                const d = new Date(); formYear.value = d.getFullYear(); formMonth.value = d.getMonth()+1; formDay.value = d.getDate();
                showModal.value = true;
            }

            const openAssetModal = () => {
                assetForm.amount = ''; assetForm.cost = ''; assetForm.name = ''; assetForm.code = ''; assetForm.action = 'buy';
                showAssetModal.value = true;
            }

            // Save Transaction (Cashflow)
            const saveTransaction = async () => {
                if (!form.amount || !form.title) return alert('Incomplete');
                const dStr = `${formYear.value}-${formMonth.value<10?'0'+formMonth.value:formMonth.value}-${formDay.value<10?'0'+formDay.value:formDay.value}`;
                const { error } = await _supabase.from('transactions').insert({ user_id: (await _supabase.auth.getUser()).data.user.id, title: form.title, amount: form.amount, type: form.type, category: form.category, date: dStr });
                if (!error) { showModal.value = false; fetchTransactions(); }
            }

            // Save Stock Transaction (Ê†∏ÂøÉ‰øÆÊîπÔºöÂåÖÂê´Ëá™Âä®Êî∂ÁõäËÆ°ÁÆó)
            const saveAssetTransaction = async () => {
                if (!assetForm.amount || !assetForm.name) return alert('Please fill in info');
                
                const d = new Date();
                const dStr = `${d.getFullYear()}-${d.getMonth()+1<10?'0'+(d.getMonth()+1):d.getMonth()+1}-${d.getDate()<10?'0'+d.getDate():d.getDate()}`;
                const user_id = (await _supabase.auth.getUser()).data.user.id;
                
                const codeStr = assetForm.code ? `(${assetForm.code})` : '';
                const fullName = `${assetForm.name} ${codeStr}`;

                if (assetForm.action === 'buy') {
                    // ‰π∞ÂÖ•ÔºöÁõ¥Êé•ËÆ∞ÂΩï‰∏ÄÁ¨î‚ÄúÊäïËµÑ‚ÄùÊîØÂá∫
                    await _supabase.from('transactions').insert({ 
                        user_id, 
                        title: `Buy: ${fullName}`, 
                        amount: assetForm.amount, 
                        type: 'expense', 
                        category: 'ÊäïËµÑ', 
                        date: dStr 
                    });
                } else {
                    // ÂçñÂá∫ÔºöÊ†πÊçÆ‰Ω†ÁöÑÈúÄÊ±Ç 5ÔºåÁî±Á≥ªÁªüËÆ°ÁÆóÊî∂Áõä
                    const sellAmount = Number(assetForm.amount);
                    const cost = Number(assetForm.cost);
                    const profit = sellAmount - cost;

                    // ‰∏∫‰∫ÜËÆ©Êï∞ÊçÆÈÄªËæë‰∏•Ë∞®ÔºåÊàë‰ª¨ÁîüÊàê‰∏§Êù°ËÆ∞ÂΩïÔºö
                    
                    // 1. ËÆ∞ÂΩïÊú¨ÈáëÂõûÊî∂ (Investment Return) -> ËÆ∞ÂΩï‰∏∫ 'ÊäïËµÑ' Á±ªÂûãÁöÑÊî∂ÂÖ•ÔºåÁî®Êù•ÊäµÊ∂à‰πãÂâçÁöÑÊîØÂá∫Ôºå‰ΩÜ‰∏çËÆ°ÂÖ• Profit ÂõæË°®
                    if (cost > 0) {
                        await _supabase.from('transactions').insert({ 
                            user_id, 
                            title: `Principal: ${fullName}`, 
                            amount: cost, 
                            type: 'income', 
                            category: 'ÊäïËµÑ', // ‰ΩøÁî®'ÊäïËµÑ'‰Ωú‰∏∫Êî∂ÂÖ•Á±ªÂà´Ôºå‰ª£Ë°®ÂõûÊ¨æ
                            date: dStr 
                        });
                    }

                    // 2. ËÆ∞ÂΩïÂáÄÊî∂Áõä (Profit) -> ËÆ∞ÂΩï‰∏∫ 'ÁêÜË¥¢Êî∂Áõä'ÔºåËøôÈÉ®ÂàÜ‰ºöÊòæÁ§∫Âú®ÊúàÂ∫¶Êî∂ÁõäÂõæË°®Èáå
                    await _supabase.from('transactions').insert({ 
                        user_id, 
                        title: `Sell: ${fullName}`, 
                        amount: profit, 
                        type: 'income', 
                        category: 'ÁêÜË¥¢Êî∂Áõä', 
                        date: dStr 
                    });
                }
                
                showAssetModal.value = false; 
                fetchTransactions();
            }

            const deleteTransaction = async (id) => { if(confirm('Delete?')) { await _supabase.from('transactions').delete().eq('id', id); fetchTransactions(); } }

            onMounted(async () => {
                const { data: { session } } = await _supabase.auth.getSession();
                if(session) {
                    window.addEventListener('resize', () => { 
                        if(dailyChart) dailyChart.resize(); 
                        if(historyChart) historyChart.resize(); 
                        if(pieChart) pieChart.resize(); 
                        if(stockTrendChart) stockTrendChart.resize();
                        if(stockAllocChart) stockAllocChart.resize();
                    });
                    fetchTransactions();
                }
            })

            return { mobileMenuOpen, lifetimeStats, currentMonthStats, savingsRate, filteredTransactions, investmentTransactions, investmentStats, showModal, showAssetModal, showMonthPicker, form, assetForm, currentCategories, selectedYear, selectedMonth, formYear, formMonth, formDay, daysInFormMonth, setMonth, openAddModal, openAssetModal, saveTransaction, saveAssetTransaction, deleteTransaction, nFormatter, isDark, toggleTheme, currentView, switchView }
        }
    }).mount('#app')
</script>
</body>
</html>
